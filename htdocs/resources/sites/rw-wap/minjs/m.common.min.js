function uaMatch(e){e=e.toLowerCase();var a=rwebkit.exec(e)||ropera.exec(e)||rmsie.exec(e)||e.indexOf("compatible")<0&&rmozilla.exec(e)||[];return{browser:a[1]||"",version:a[2]||"0"}}jQuery.extend({browser:function(){var e={},a=window.navigator.userAgent,r=uaMatch(a);return r.browser&&(e[r.browser]=!0,e.version=r.version),{browser:e}}}),function(e){e.fn.delayKeyup=function(a,r){var t=0;return e(this).on("keyup",function(e){if(clearTimeout(t),!a||"function"!=typeof a)throw new Error("Callback Error");t=setTimeout(function(){a(e)},r)}),e(this)}}(jQuery),window.FUN={},FUN.Search={seach_submit:function(e){var a=this;e.submit(function(e){return a.seachFormOpearal(this)})},ucwords:function(e){var a=(e+"").replace(/^([a-z\u00E0-\u00FC])|\s+([a-z\u00E0-\u00FC])/g,function(e){return e.toUpperCase()});return a=encodeURIComponent($.trim(a)),a=a.replace("/[^w.]/g","-"),a=a.replace("%20","-").toLowerCase(),a=$.trim(e),a=a.replace(/\*/g,"~~"),a=a.replace(/\|/g,"]]"),a=a.replace(/\=/g,"(("),a=a.replace(/\"/g," "),a=a.replace(/\</g,"))"),a=a.replace(/\>/g,")))"),a=a.replace(/\?/g,"!!!"),a=a.replace(/\+/g,"__"),a=a.replace(/\//g,".."),a=a.replace(/\\/g,"..."),a=a.replace(/\%/g,"!!"),a=a.replace(/\#/g,"~~~"),a=a.replace(/\>/g,"___"),a=a.replace(/\</g,"^^^"),a=a.replace(/\"/g,"[["),a=a.replace(/\$/g,"[[["),a=a.replace(/\s+/g,"-"),a=a.toLowerCase(),a=a.replace(/\b\w+\b/g,function(e){return e})},seachFormOpearal:function(e){var a=$(e),r=a.find('input[name="k2"]'),t=this.ucwords(r.val());return""==t?r.focus():(layer.open({type:2,shadeClose:!1}),window.location.href=DOMAIN+"cheap/"+t+"/"),!1},searchAjax:{param:{requestUrl:DOMAIN+"index/search",searchInput:$("#js_topSearch"),searchDrop:$("#js_topSearchDrop")},defaultWords:"",getData:function(e){var a=this,r=e.split(" ");r[1]||r[r.length-1]||(e=r[0]),e?$.get(a.param.requestUrl,{keyword:e,dataType:"json",action:"show_word"},function(e){a.renderData(e)},"jsonp"):a.setDefaultWords()},renderData:function(e){var a=this;"fail"!=e.res?a.toggleSearch(!0,function(){a.param.searchDrop.empty().html(e.res)}):a.setDefaultWords()},setDefaultWords:function(){var e=this;e.toggleSearch(!1,function(){e.param.searchDrop.empty().html(e.defaultWords)})},toggleSearch:function(e,a){var r=this;e?r.param.searchDrop.show():r.param.searchDrop.hide(),"function"==typeof a&&a&&a()},setKeyword:function(e,a){this.param.searchInput.val(e),a?window.location.href=a:$("#js_topSeachForm").trigger("submit"),this.toggleSearch(!1)},bindEvent:function(){var e=this,a=e.param.searchInput;a.delayKeyup(function(r){var t=[37,38,39,40,116,27];t.indexOf(r.keyCode)==-1&&e.getData(a.val())},600),$(document).on("click",function(a){var r=$(a.target).closest("form").attr("id");"js_topSeachForm"!=r&&e.toggleSearch(!1)}),a.on("click",function(){e.toggleSearch(!0)}),e.param.searchDrop.on("click","li",function(a){var r=$(this),t=r.find("a").data("url"),n=r.find("a").text();n&&e.setKeyword(n,t)})},init:function(e){var a=this;$.extend(!0,a.param,e);a.defaultWords=a.param.searchDrop.html(),a.bindEvent()}}},FUN.cart={cartItems:function(){$.ajax({url:WAP_URL+"misc/get-cart-num",dataType:"jsonp",crossDomain:!0,jsonp:"jsoncallback"}).done(function(e){document.getElementById("cartNum").innerHTML=e.data.cart_num})},addNum:function(e){var a=Number(e.val());e.val(a+1).keyup(),a>=1&&e.siblings(".js_reduceNum").removeClass("disabled")},reduceNum:function(e){var a=Number(e.val());a<3?e.siblings(".js_reduceNum").addClass("disabled"):"",a>1?e.val(a-1).keyup():""},enterNum:function(e,a){var r,t,n=$(e),o=parseInt(n.val()),s=$("#unit_price"),i=$("#addCart,#add_stay");if($.trim(n.val()).length)return isNaN(o)||0==o?void n.val(1):arguments.length>1&&1==a?void i.data("num",o):void(o<9999&&($("input.js_orangNum").each(function(e,a){r=$(this).data("val").toString(),r=parseInt(r.replace(/[\u4e00-\u9fa5]/g,""),10),o>=r&&(t=$("#pk"+$(this).data("atrp")).attr("data-orgp"),s.attr("data-orgp",t))}),FUN.currency.change_houbi("",s.parent()),i.data("num",o),n.val(o)))},addCart:function(e,a){var r=$(e),t=$(e).data("peijian"),n="",o=$(e).data("active_type"),s="",i=$(e).data("stay"),c=$(e).data("sk"),l=0;return"undefined"!=typeof t&&(n=t.toString().split("|")),"undefined"!=typeof o&&(s=o),"undefined"!=typeof i&&(l=i),!r.hasClass("disabled")&&(r.prop("disabled",!0),void $.ajax({url:CART_URL+"order/cart/add",dataType:"jsonp",crossDomain:!0,jsonp:"jsoncallback",data:{goods_id:r.data("gid"),peijian_id:n,sk_id:c,active_type:s,number:r.data("num")?r.data("num"):1},beforeSend:function(){layer.open({type:2,shadeClose:!1})}}).done(function(e){if(layer.closeAll(),0==e.code){if(1==l){FUN.cart.cartItems();var t=e.data.goods_thumb,n=e.data.size,o=e.data.color,s=e.data.shop_price;$("#js_pop_add_cart .js_pic").attr("src",t),$("#js_pop_add_cart .js_size").text(n),$("#js_pop_add_cart .js_color").text(o),$("#js_pop_add_cart .js_price").text(s),""==n&&$("#js_pop_add_cart .js_size").parent().hide(),""==o&&$("#js_pop_add_cart .js_color").parent().hide(),$("#js_pop_add_cart").show(),setTimeout(function(){$("#js_pop_add_cart").hide()},3e3),r.prop("disabled",!1)}else location.href=CART_URL+"order/cart/cart";a&&"function"==typeof a&&(r.prop("disabled",!1),a(e))}else 2==e.code?$(".js_backdrop").fadeIn("fast",function(){$(".js_msg_alert").fadeIn("swing")}):(r.prop("disabled",!1),layer.open({content:e.msg,shadeClose:!1,btn:["OK"],yes:function(){window.location.reload()}}))}))},addWishList:function(e,a){var r=$(e),t=r.data("url")?r.data("url"):DOMAIN+"goods/goods/add-to-collect/"+r.data("gid");$.ajax({url:t,dataType:"jsonp",crossDomain:!0,jsonp:"jsoncallback"}).done(function(e){switch(layer.closeAll(),e.code){case 0:var t=r.find(".fav_num");t.length&&t.html(parseInt(t.data("num"))+1),r.addClass("on"),layer.open({btn:[jsLg.ok],content:jsLg.userCenter.addWishList}),a&&"function"==typeof a&&a(e);break;case 1:r.addClass("on"),layer.open({btn:[jsLg.ok],content:jsLg.userCenter.repeatAddWishList});break;case 2:location.href=LOGIN_URL+"user/login/sign?return=back"}})}},FUN.sign={isLogin:function(e){$.ajax({url:WAP_URL+"misc/check-login",dataType:"jsonp",crossDomain:!0,jsonp:"jsoncallback"}).done(function(a){e&&"function"==typeof e&&e(a)})},register:function(e,a){e.validate({rules:{email:{required:!0,maxlength:60,email:!0,remote:{url:"/dist/json/emailValidation.json",type:"post",data:{email:function(){return $("input[name=email]").val()}}}},password:{required:!0,maxlength:60,minlength:6},re_password:{required:!0,minlength:6,maxlength:60,equalTo:"input[name=password]"},birthday:{required:!0}},messages:{email:{required:jsLg.formMsg.email_require_msg,maxlength:jsLg.formMsg.email_maxlength_msg,email:jsLg.formMsg.email_require_msg,remote:jQuery.format(jsLg.formMsg.email_in_user)},password:{required:jsLg.formMsg.password,minlength:jsLg.formMsg.password_minlength,rangelength:jQuery.format(jsLg.formMsg.password_minlength)},re_password:{required:jsLg.formMsg.password_repeat,minlength:jQuery.format(jsLg.formMsg.password_minlength),equalTo:jsLg.formMsg.password_repeat},birthday:{required:jsLg.formMsg.email_require_msg}},submitHandler:function(e){a&&"function"==typeof a&&a(e)},errorPlacement:function(e,a){e.appendTo(a.parent())},success:function(e){e.remove()}})},login:function(e,a){e.validate({rules:{email:{required:!0,maxlength:60,email:!0},password:{required:!0,maxlength:60,minlength:6}},messages:{email:{required:jsLg.formMsg.email_require_msg,maxlength:jsLg.formMsg.email_maxlength_msg,email:jsLg.formMsg.email_require_msg},password:{required:jsLg.formMsg.password,minlength:jsLg.formMsg.password_minlength}},submitHandler:function(e){a&&"function"==typeof a&&a(e)},errorPlacement:function(e,a){e.appendTo(a.parent())},success:function(e){e.remove()}})}},FUN._GET=function(e,a){var r=new RegExp("[?&]"+e+"=([^&]+)","g");a=a||location.search;for(var t,n="";null!==(t=r.exec(a));)n=t[1];return decodeURIComponent(n)},FUN.referrer=function(e){var a=FUN._GET("return");"back"==a?window.location.href=document.referrer:a.indexOf("http://")>=0||a.indexOf("https://")>=0?window.location.href=a:window.location.href=e},function(e){function a(a,r){var t=e(".my_shop_price"),o=r,s=l[a];t.each(function(e,a){var r=a.dataset.orgp;r&&(a.innerHTML=o+" "+n(r,s).toFixed(2))})}function r(e,a){var r=30,t=new Date;t.setTime(t.getTime()+24*r*60*60*1e3),document.cookie=e+"="+escape(a)+";expires="+t.toGMTString()+";path=/;domain="+i}function t(e){var a,r=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(a=document.cookie.match(r))?a[2]:null}function n(e,a){var r=0,t=e.toString(),n=a.toString();try{r+=t.split(".")[1].length}catch(o){}try{r+=n.split(".")[1].length}catch(o){}return Number(t.replace(".",""))*Number(n.replace(".",""))/Math.pow(10,r)}var o,s=function(t){return t.getDiamon=function(){var e,a=window.location.host;return a.replace(/.[A-Za-z0-9_-]*/,function(a){e=a}),window.location.host.substr(e.length,a.length)},t.goTop=function(){var e=jQuery("body"),a=jQuery('<div class="back-to-top none">top</div>');e.append(a),a.on("click",function(){e.animate({scrollTop:"0"},300)})},t.fixNav=function(){var a=document;jQuery(a).height()>=1.3*window.screen.availHeight&&jQuery(a).scrollTop()>=120?e("#header").addClass("slide--up").removeClass("slide--reset"):e("#header").addClass("slide--reset").removeClass("slide--up")},t.seach_submit=function(e){var a=this;e.submit(function(e){return a.seachFormOpearal(this)})},t.ucwords=function(a){var r=(a+"").replace(/^([a-z\u00E0-\u00FC])|\s+([a-z\u00E0-\u00FC])/g,function(e){return e.toUpperCase()});return r=encodeURIComponent(e.trim(r)),r=r.replace("/[^w.]/g","-"),r=r.replace("%20","-").toLowerCase(),r=r.replace(/\*/g,"~~"),r=r.replace(/\|/g,"]]"),r=r.replace(/\=/g,"(("),r=r.replace(/\"/g," "),r=r.replace(/\</g,"))"),r=r.replace(/\>/g,")))"),r=r.replace(/\?/g,"!!!"),r=r.replace(/\+/g,"__"),r=r.replace(/\//g,".."),r=r.replace(/\\/g,"..."),r=r.replace(/\%/g,"!!"),r=r.replace(/\#/g,"~~~"),r=r.replace(/\>/g,"___"),r=r.replace(/\</g,"^^^"),r=r.replace(/\"/g,"[["),r=r.replace(/\$/g,"[[["),r=r.replace(/\s+/g,"-"),r=r.toLowerCase(),r=r.replace(/\b\w+\b/g,function(e){return e})},t.seachFormOpearal=function(a){var r=e(a),t=r.find('input[name="k2"]'),n=this.ucwords(t.val());if(""==n)t.focus();else{layer.open({type:2,shadeClose:!1});var o="https://m.rosewholesale.com/";window.location.href=o+"cheap/"+n+"/"}return!1},t.changeBizhong=function(t,n){r("bizhong",t),a(t,n),e(this).parents(".mm-listitem_vertical").removeClass("mm-listitem_opened"),e(".js_currency-button").html('<label><i class="left-menu-icon bzIcon"></i>'+n+"</label>"+t),e.each(e("#js_currencyMenu").find("li"),function(a,r){var n=e(r);if(n.data("bizhong")==t)return n.addClass("current").siblings("li").removeClass("current")})},t}({}),i=s.getDiamon(),c=JSON.parse(e('input[name="exchange"]').val()),l=c.Rate,u=c.Sign,d=t("bizhong");c&&(o=u[d]),d||(d="USD",o="$"),s.changeBizhong(d,o),jQuery(document).ready(function(e){s.goTop();var t=e("#js_navTopmenu"),n=e("#gs_menuAside");n.mmenu({extensions:["border-full","fx-menu-zoom","fx-panels-slide-0","widescreen","shadow-page"]});var o=n.data("mmenu");t.on("click",function(){t.addClass("drawer-open"),o.open()}),e(".mm-page__blocker").on("touchstart tap click",function(){t.removeClass("drawer-open"),o.close()}),e("#js_showSearchBox").on("click",function(){e("div[data-position='top']").slideToggle("fast").addClass("on")});var i=e(".js_searchBox"),c=i.find("input[name='k2']"),l=i.find(".js_clearIpt");c.on("keyup",function(){var a=e(this);a.val()?a.closest(".js_searchBox").addClass("focus"):a.closest(".js_searchBox").removeClass("focus")}),l.on("click",function(){var a=e(this);a.prev("input[name='k2']").val("").end().closest(".js_searchBox").removeClass("focus")});var u=null,d=0,p=0;e(window).on("scroll",function(){u&&clearTimeout(u),u=setTimeout(function(){return d=e(this).scrollTop(),p<d||d<50?e(".back-to-top").fadeOut():e(".back-to-top").fadeIn(),setTimeout(function(){p=d},0),s.fixNav(),!1},25)}),e("body").on("click","#js_currencyMenu li",function(t){var n=e(this).attr("data-bizhong"),o=e(this).attr("data-icon");if(n){var s=n,i=o;r("bizhong",s),a(s,i),e(this).parents(".mm-listitem_vertical").removeClass("mm-listitem_opened"),e(".js_currency-button").html('<label><i class="left-menu-icon bzIcon"></i>'+o+"</label>"+s),e.each(e("#js_currencyMenu").find("li"),function(a,r){var t=e(r);if(t.data("bizhong")==s)return t.addClass("current").siblings("li").removeClass("current")})}}),e(".back-to-top").on("click",function(){e("html").animate({scrollTop:"0"},300)}),e.fn.lazyload&&e("img.lazyload").lazyload({threshold:100,effect:"fadeIn",failure_limit:20,skip_invisible:!1}),FUN.cart.cartItems(),function(){var a=e("#js_topSeachForm"),r=e("#js_leftSeachForm");a.length?FUN.Search.seach_submit(a):"",r.length?FUN.Search.seach_submit(r):""}(),FUN.sign.isLogin(function(a){a.data.logined?(e(".isLogin").show(),1==a.data.giftCard&&e("#js_giftCard").show()):e(".isNoLogin").show()})})}($),function(){var e=$(".js_searchBox"),a=(e.data("position"),e.find("input[name='k2']")),r=e.find(".js_clearIpt");a.on("keyup",function(){var e=$(this);e.val()?e.closest(".js_searchBox").addClass("focus"):e.closest(".js_searchBox").removeClass("focus")}),r.on("tap",function(){var e=$(this);e.prev("input[name='k2']").val("").end().closest(".js_searchBox").removeClass("focus")}),$("#js_showSearchBox").on("tap",function(){$("div[data-position='top']").slideToggle("fast").addClass("on")}),$(window).on("scroll",function(){$("#js_topSearchDrop").hide(0)})}(),FUN.Search.searchAjax.init(),$("#subscribe_form").submit(function(){var e=$(this),a=e.find("input[type=text]"),r=/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/;return r.test(a.val())?void $.ajax({type:"POST",dataType:"json",data:{email_check:1,user_email:a.val()},url:DOMAIN+"misc/check-email-subscribe/",beforeSend:function(){layer.open({type:2,shadeClose:!1})},success:function(e){if(layer.closeAll(),"0"==e.status)layer.open({content:e.msg,btn:[jsLg.yes],yes:function(){layer.closeAll()},end:function(){a.focus()}});else{for(var r=a.val(),t=String.fromCharCode(r.charCodeAt(0)+r.length),n=1;n<r.length;n++)t+=String.fromCharCode(r.charCodeAt(n)+r.charCodeAt(n-1));t=encodeURIComponent(t),location.href=DOMAIN+"misc/email-subscribe/?email="+t}}}):(layer.open({content:jsLg.formMsg.email_require_msg,btn:[jsLg.yes],yes:function(){layer.closeAll()},end:function(){a.focus()}}),!1)});