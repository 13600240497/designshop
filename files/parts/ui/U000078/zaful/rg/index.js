"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};$(function(){function p(t){var e=parseInt($(t).find(".gs-goods-singleTab").attr("data-default-g-count")),n=parseInt($(t).find(".gs-goods-singleTab").attr("data-fixed-g-count")),a=$(t).attr("data-key"),o=$(t).attr("data-id"),s=""!=$(t).find(".gs-goods-singleTab").attr("data-skus")?parseInt($(t).find(".gs-goods-singleTab").attr("data-skus").split(",").length):"",i=function(t,e,n){var a=[];if(e<=n&&0<=t){for(var o=e;o<=n;o++)a.push(o);a.sort(function(){return.5-Math.random()}),a.length=n+1-e<t?n+1-e:t}return a}(e-n,n,s-1),d={time:(new Date).getTime(),skus:i,default_count:e,fixed_count:n};if(localStorage.setItem("geshop_goods_"+a+"_"+o,JSON.stringify(d)),e<n){$(t).find(".goods-item").css("display","none");for(var r=0;r<e;r++)$(t).find(".goods-item").eq(r).css("display","block");return!1}$(t).find(".goods-item").each(function(t,e){n-1<t&&$(e).css("display","none")});for(r=0;r<i.length;r++)$(t).find(".goods-item").eq(i[r]).css("display","block")}function m(t){var e,n=parseInt($(t).find(".gs-goods-singleTab").attr("data-default-g-count")),a=parseInt($(t).find(".gs-goods-singleTab").attr("data-fixed-g-count")),o=$(t).attr("data-key"),s=$(t).attr("data-id"),i=parseInt($(t).find(".gs-goods-singleTab").attr("data-skus").split(",").length),d=parseInt($(t).find(".gs-goods-singleTab").attr("data-init-time")),r=[];if(n){for(var l=a;l<=i-1;l++)r.push(l);r.length=n-a,e={time:d,skus:r,default_count:n,fixed_count:a},localStorage.setItem("geshop_goods_"+o+"_"+s,JSON.stringify(e)),$(t).find(".goods-item").each(function(t,e){a-1<t&&$(e).css("display","none")});for(l=0;l<r.length;l++)$(t).find(".goods-item").eq(r[l]).css("display","block")}}if(h){"1"==$("[data-editenv]:eq(0)").data("editenv")&&$(".gs-tab-content").find(".gs-tab-item:eq(0)").addClass("gs-tab-show").siblings().removeClass("gs-tab-show"),$(".gs-goods-title").next().css({height:"72px",width:"850px"}),$(".gs-goods-singleTab").removeAttr("data-tplstatus"),setTimeout(function(){h.tabScrollEvent()},200)}else{var n=function(o){var s=o,t=$(s).data("skus"),n=$(s).find(".gs_syncDefault").html();if(!t)return!1;var a=$("[data-editenv]:eq(0)").data("editenv");h.getTplProduct(t,o).done(function(t){"1"==a&&(Design.disableLoading(),Design.disableLayuiLoading());var e=t.data.goodsInfo;"0"==t.code&&e&&(gs_laytpl.config({open:"<%",close:"%>"}),gs_laytpl(n).render(e,function(t){if(t){if($(s).find(".gs-goodsWrap ul").html(t),$("[data-gid=U000078_zaful]").each(function(t,e){if(window.localStorage){var n=(new Date).getTime(),a=parseInt($(e).find(".gs-goods-singleTab").attr("data-fixed-g-count")),o=parseInt($(e).find(".gs-goods-singleTab").attr("data-default-g-count")),s=$(e).attr("data-key"),i=$(e).attr("data-id"),d=JSON.parse(localStorage.getItem("geshop_goods_"+s+"_"+i));if(d){var r=d.time,l=d.skus,g=d.default_count,f=d.fixed_count,u=Math.floor(n-r)/36e5;if(o==g&&a==f)if(4<=u)p(e);else{$(e).find(".goods-item").each(function(t,e){a-1<t&&$(e).css("display","none")});for(var c=0;c<l.length;c++)$(e).find(".goods-item").eq(l[c]).css("display","block")}else m(e)}else m(e)}else setInterval(function(){p(e)},144e5)}),$(s).find(".gs-goodsWrap").css("min-height","auto"),GESHOP_UTIL.goodsLazy($(s).find(".js-geshopImg-lazyload")),"undefined"!=typeof GLOBAL&&GLOBAL.currency.change_html){var e=h.getCookie("bizhong")||"USD",n=$(o);GLOBAL.currency.change_html(e,n)}var a=$(s).find(".gs_component_countDown").data("status");$(s).find(".gs-btn-area .gs-btn").text(i[a]),$(s).find(".kill_soldout .gs-btn-area .gs-btn").text(i[3]),$(s).find(".kill_soldout a").removeAttr("href")}}))}).fail(function(){"1"==a&&($(s).find(".gs-goodsWrap ul").html('<span style="font-size: 14px;">错误:接口商品数据为空</span>'),Design.disableLoading(),Design.disableLayuiLoading())}).always(function(){"1"==a&&(Design.disableLoading(),Design.disableLayuiLoading())})},i=[GESHOP_LANGUAGES.btn_coming_soon,GESHOP_LANGUAGES.btn_buy_now,GESHOP_LANGUAGES.btn_ended,GESHOP_LANGUAGES.btn_sold_out];GESHOP_LANGUAGES.down_starts,GESHOP_LANGUAGES.down_ends;if(!h)var h=(o=h||{},b=$(".gs-goods-singleTab .gs_component_countDown"),o.initCountDown=function(){(b=$(".gs-goods-singleTab .gs_component_countDown")).each(function(){var t=$(this),e=t.prev("input[name=serverTime]"),n=0,a=0,o=(new Date).getTime()||parseInt(e.val()),s=parseInt(e.attr("data-start-time")),i=parseInt(e.attr("data-end-time")),d=e.attr("data-textobj").split(",");if(s){var r=new Date(s),l=new Date(o);r.getDate(),r.getMonth(),r.getFullYear(),l.getDate(),l.getMonth(),l.getFullYear()}var g=Math.round(o/1e3),f=Math.round(s/1e3),u=Math.round(i/1e3);g<f?n=f-g:f<=g&&g<u?(a=1,n=u-g):u<g&&(a=2,n=0),t.data({leftTime:n,status:a}),t.prev().prev().text(d[a])})},o.compoentCountDown=function(){b.each(function(){var t,e,n,a,o,s,i,d,r=$(this),l=r.closest(".gs-time-inner"),g=r.prev("input[name=serverTime]"),f=(parseInt(g.attr("data-start-time")),parseInt(r.data("leftTime"))),u=parseInt(r.data("status")),c=r.closest(".gs-goods-singleTab").attr("data-killLeftVisible"),p=r.parents('[data-gid="U000078_zaful"]:eq(0)');if(!f&&"2"==u)return b=b.not(r),void("0"==c?p.hide():l.find(".gs-down-inner").hide());!isNaN(f)&&0<=f?(t=f,e=Math.floor(t/60),n=Math.floor(e/60),a=(a=Math.floor(n/24))<10?"0"+a:a,o=(o=n%24)<10?"0"+o:o,s=(s=e%60)<10?"0"+s:s,i=(i=Math.floor(t%60))<10?"0"+i:i,d=n<10?"0"+n:n,r.data("left-time",f-1),-1<("undefined"!=typeof GESHOP_SITECODE?GESHOP_SITECODE:"rw-pc").indexOf("zf")?r.html("<span><em>"+d+"</em>:<em>"+s+"</em>:<em>"+i+"</em></span>"):r.html("<span><em>"+a+"</em>:<em>"+o+"</em>:<em>"+s+"</em>:<em>"+i+"</em></span>")):(b=b.not(r),2!==u?h.initCountDown():(r.html("<span><em>00</em>:<em>00</em>:<em>00</em>:<em>00</em></span>"),"0"==c?p.hide():l.find(".gs-down-inner").hide()))}),0!==b.length&&setTimeout(h.compoentCountDown,1e3)},o.extendDeep=function(t,e){var n,a=Object.prototype.toString;for(n in e=e||{},t)t.hasOwnProperty(n)&&("object"===_typeof(t[n])?(e[n]="[object Array]"===a.call(t[n])?[]:{},o.extendDeep(t[n],e[n])):e[n]=t[n]);return e},o.gsTplInt=function(){gs_laytpl.config({open:"<%",close:"%>"})},o.getTplProduct=function(t,e){var n={lang:"undefined"!=typeof GESHOP_LANG?GESHOP_LANG:"en",goodsSn:t,pipeline:"undefined"!=typeof GESHOP_PIPELINE?GESHOP_PIPELINE:"",v:"2"},a=$(e).attr("data-interfaceDomain")+"/geshop/goods/timeseckilldetail",o=$(e).parents(".geshop-component-box").eq(0).attr("data-id");return window.GEShopCommonFn_Vue.$jsonp(a,n,{pid:o})},o.throttle=function(e,n,a){var o=null,s=null;return function(){var t=+new Date;s=s||t,a&&a<t-s?(e(),s=t,clearTimeout(o)):(clearTimeout(o),o=setTimeout(function(){e(),s=null},n))}},o.setCookie=function(t,e){var n=new Date;n.setTime(n.getTime()+2592e6),document.cookie=t+"="+escape(e)+";expires="+n.toGMTString()+";path=/;domain="+COOKIESDIAMON},o.getCookie=function(t){var e,n=new RegExp("(^| )"+t+"=([^;]*)(;|$)");return(e=document.cookie.match(n))?e[2]:null},o.tabScrollEvent=function(){var t=$(".gs-goods-singleTab");t.length&&t.each(function(t,e){n($(e))})},o);var t=$("[data-static-domain]:eq(0)").attr("data-static-domain")?$("[data-static-domain]:eq(0)").attr("data-static-domain"):"";$LAB.script(t+"/resources/javascripts/library/jquery.SuperSlide.2.1.x.js").script(t+"/resources/javascripts/library/gs_laytpl.js?2018100101").wait(function(){h.initCountDown(),h.compoentCountDown(),h.gsTplInt(),h.tabScrollEvent()})}var o,b});