"use strict";$(function(){var t=$(".wrap-U000041_view").find(".gs-tab-box li");function a(){$('[data-gid="U000041_view"]').each(function(t,r){if(window.localStorage){var f=(new Date).getTime(),c=parseInt($(r).find(".gs-tab").attr("data-fixed-g-count")),g=parseInt($(r).find(".gs-tab").attr("data-default-g-count")),l=$(r).attr("data-key"),p=$(r).attr("data-id");$(r).find(".gs-tab-item").each(function(t,a){var e=JSON.parse(localStorage.getItem("geshop_goods_"+l+"_"+p+"_tab_"+t));if(e){var i=e.time,s=e.skus,o=e.default_count,n=e.fixed_count,d=Math.floor(f-i)/36e5;if(g==o&&c==n)if(4<=d)h(t,a);else{$(a).find(".goods-item").each(function(t,a){c-1<t&&$(a).css("display","none")});for(t=0;t<s.length;t++)$(a).find(".goods-item").eq(s[t]).css("display","block")}else u(r)}else u(r)})}else setInterval(function(){h(r)},144e5)})}function h(t,a){var e=parseInt($(a).parents(".gs-tab").attr("data-default-g-count")),i=parseInt($(a).parents(".gs-tab").attr("data-fixed-g-count")),s=$(a).parents(".clearfix").attr("data-key"),o=$(a).parents(".clearfix").attr("data-id"),n=parseInt($(a).attr("data-total")),d=function(t,a,e){var i=[];if(a<=e&&0<=t){for(var s=a;s<=e;s++)i.push(s);i.sort(function(){return.5-Math.random()}),i.length=e+1-a<t?e+1-a:t}return i}(e-i,i,n-1),r={time:(new Date).getTime(),skus:d,default_count:e,fixed_count:i};if(localStorage.setItem("geshop_goods_"+s+"_"+o+"_tab_"+t,JSON.stringify(r)),e<i){$(a).find(".goods-item").css("display","none");for(var f=0;f<e;f++)$(a).find(".goods-item").eq(f).css("display","block");return!1}$(a).find(".goods-item").each(function(t,a){i-1<t&&$(a).css("display","none")});for(f=0;f<d.length;f++)$(a).find(".goods-item").eq(d[f]).css("display","block")}function u(t){var s,o=parseInt($(t).find(".gs-tab").attr("data-default-g-count")),n=parseInt($(t).find(".gs-tab").attr("data-fixed-g-count")),d=$(t).attr("data-key"),r=$(t).attr("data-id"),f=parseInt($(t).find(".gs-tab").attr("data-init-time")),c=[];o&&$(t).find(".gs-tab-item").each(function(t,a){for(var e=parseInt($(a).attr("data-total")),i=n;i<=e-1;i++)c.push(i);c.length=o-n,s={time:f,skus:c,default_count:o,fixed_count:n},localStorage.setItem("geshop_goods_"+d+"_"+r+"_tab_"+t,JSON.stringify(s)),$(a).find(".goods-item").each(function(t,a){n-1<t&&$(a).css("display","none")});for(i=0;i<c.length;i++)$(a).find(".goods-item").eq(c[i]).css("display","block")})}$(".gs-tab-box").each(function(){var t=$(this);t.width();1100<t.find(".goods-nav-name").width()&&($(".geshop-tab-btn",t).addClass("gs-btn-show"),function(t){var a=$("[data-static-domain]:eq(0)").attr("data-static-domain")?$("[data-static-domain]:eq(0)").attr("data-static-domain"):"";loadCss(a+"/resources/javascripts/library/swiper/swiper.min.css"),$LAB.script(a+"/resources/javascripts/library/swiper/swiper.3.4.spec.min.js").wait(function(){new Swiper3(t.find(".swiper-container"),{autoplay:!1,slidesPerView:"auto",slideToClickedSlide:!0,nextButton:t.find(".next-btn"),prevButton:t.find(".pre-btn"),lazyLoading:!0})})}(t))}),t.on("click",function(){var t=$(this).parents(".gs-tab-wrap:eq(0)").next(".gs-tab-content"),a=$(this).index();$(this).addClass("current").siblings().removeClass("current"),t.find(".gs-tab-item:eq("+a+")").addClass("gs-tab-show").siblings().removeClass("gs-tab-show"),GESHOP_UTIL&&GESHOP_UTIL.goodsLazy(t.find(".gs-tab-item:eq("+a+") img.js-geshopImg-lazyload")),$("html,body").animate({scrollTop:$(this).closest(".geshop-component-box").offset().top-GESHOP_UTIL.getSiteFiedHeader()},500)}),a(),setInterval(function(){a()},1e3),$(".gs-tab-item").each(function(t,a){$(a).find(".quick_view").on("click",function(t){t.stopPropagation();var a=$(this).attr("data-site").split("-")[0],e=$(this).attr("data-goodsId"),i=$(this).attr("data-siteDomain"),s="";switch(a){case"rw":s=i+"/m-goods_fast-a-info.htm?goods_id="+(e=e.slice(0,7));break;case"zf":s=i+"/m-goods_fast-a-info.htm?goods_id="+(e=e.slice(0,6));break;case"rg":s=i+"/m-goods-a-fast-id-"+(e=e.slice(0,7))+".html"}return s&&GEShopSiteCommon.dialog.iframe(s,1080,597,!0),!1})});var d=[];function e(e){$.each(d,function(t,a){if(1==a.tabWrap.data("tab-fix")){$(a.tab).closest(".geshop-component-box").data("id"),a.tabWrap.offset().top;e+2>=a.tabWrap.offset().top&&a.tabWrap.offset().top+a.tabWrap.outerHeight(!0)>=a.tabHeight+e?(a.tab.css({position:"fixed",height:a.tabHeight,width:a.tabWrap.outerWidth(),left:a.tabWrap.offset().left,top:0,overflow:"hidden","z-index":9999}),a.tabWrap.parents('[data-key="U000041"]').addClass("js-geshop-nav-fixed"),$(".js-geshop-nav").length&&$(".js-geshop-nav").hide(),$('div[data-key="U000027"]').length&&$('div[data-key="U000027"]').find("ul").hide()):(a.tab.css({position:"static",top:0}),a.tabWrap.parents('[data-key="U000041"]').removeClass("js-geshop-nav-fixed"),$(".js-geshop-nav").length&&$(".js-geshop-nav").show(),$('div[data-key="U000027"]').length&&$('div[data-key="U000027"]').find("ul").show())}}),GEShopSiteCommon&&GEShopSiteCommon.jsNavFixed()}$(".gs_tab_wrap_fixed").each(function(t,a){var e=$(a);if(1!=e.data("isaddfixbox")){e.data("isaddfixbox",1);var i=e.find(".gs-tab-content"),s=e.find(".gs-tab-wrap").outerHeight(!0),o=e.find(".gs-tab-content").outerHeight(!0);e.find(".gs-tab-wrap").children().wrap('<div class="gs-tab-wrap-fixBox" style="height:'+s+'px"></div>');var n=e.find(".gs-tab-wrap-fixBox");d.push({tabWrap:e,tab:n,content:i,tabHeight:s,contentHeight:o})}}),$(window).scroll(function(){e($(this).scrollTop())}),$(window).resize(function(){e($(this).scrollTop())})});