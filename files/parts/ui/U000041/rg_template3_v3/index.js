"use strict";$(function(){var t=$(".wrap-U000041_zaful").find(".gs-tab-box li");function a(){$('[data-gid="U000041_zaful"]').each(function(t,r){if(window.localStorage){var f=(new Date).getTime(),c=parseInt($(r).find(".gs-tab").attr("data-fixed-g-count")),g=parseInt($(r).find(".gs-tab").attr("data-default-g-count")),l=$(r).attr("data-key"),p=$(r).attr("data-id");$(r).find(".gs-tab-item").each(function(t,a){var e=JSON.parse(localStorage.getItem("geshop_goods_"+l+"_"+p+"_tab_"+t));if(e){var s=e.time,i=e.skus,n=e.default_count,o=e.fixed_count,d=Math.floor(f-s)/36e5;if(g==n&&c==o)if(4<=d)h(t,a);else{$(a).find(".goods-item").each(function(t,a){c-1<t&&$(a).css("display","none")});for(t=0;t<i.length;t++)$(a).find(".goods-item").eq(i[t]).css("display","block")}else u(r)}else u(r)})}else setInterval(function(){h(r)},144e5)})}function h(t,a){var e=parseInt($(a).parents(".gs-tab").attr("data-default-g-count")),s=parseInt($(a).parents(".gs-tab").attr("data-fixed-g-count")),i=$(a).parents(".clearfix").attr("data-key"),n=$(a).parents(".clearfix").attr("data-id"),o=parseInt($(a).attr("data-total")),d=function(t,a,e){var s=[];if(a<=e&&0<=t){for(var i=a;i<=e;i++)s.push(i);s.sort(function(){return.5-Math.random()}),s.length=e+1-a<t?e+1-a:t}return s}(e-s,s,o-1),r={time:(new Date).getTime(),skus:d,default_count:e,fixed_count:s};if(localStorage.setItem("geshop_goods_"+i+"_"+n+"_tab_"+t,JSON.stringify(r)),e<s){$(a).find(".goods-item").css("display","none");for(var f=0;f<e;f++)$(a).find(".goods-item").eq(f).css("display","block");return!1}$(a).find(".goods-item").each(function(t,a){s-1<t&&$(a).css("display","none")});for(f=0;f<d.length;f++)$(a).find(".goods-item").eq(d[f]).css("display","block")}function u(t){var i,n=parseInt($(t).find(".gs-tab").attr("data-default-g-count")),o=parseInt($(t).find(".gs-tab").attr("data-fixed-g-count")),d=$(t).attr("data-key"),r=$(t).attr("data-id"),f=parseInt($(t).find(".gs-tab").attr("data-init-time")),c=[];n&&$(t).find(".gs-tab-item").each(function(t,a){for(var e=parseInt($(a).attr("data-total")),s=o;s<=e-1;s++)c.push(s);c.length=n-o,i={time:f,skus:c,default_count:n,fixed_count:o},localStorage.setItem("geshop_goods_"+d+"_"+r+"_tab_"+t,JSON.stringify(i)),$(a).find(".goods-item").each(function(t,a){o-1<t&&$(a).css("display","none")});for(s=0;s<c.length;s++)$(a).find(".goods-item").eq(c[s]).css("display","block")})}$(".gs-tab-box").each(function(){var t,a,e=$(this);e.width()<e.find(".goods-nav-name").width()&&($(".geshop-tab-btn",e).addClass("gs-btn-show"),t=e,a=$("[data-static-domain]:eq(0)").attr("data-static-domain")?$("[data-static-domain]:eq(0)").attr("data-static-domain"):"",loadCss(a+"/resources/javascripts/library/swiper/swiper.min.css"),$LAB.script(a+"/resources/javascripts/library/swiper/swiper.3.4.spec.min.js").wait(function(){new Swiper(t.find(".swiper-container"),{autoplay:!1,slidesPerView:"auto",slideToClickedSlide:!0,nextButton:t.find(".next-btn"),prevButton:t.find(".pre-btn"),lazyLoading:!0})}))}),t.on("click",function(){var t=$(this).parents(".gs-tab-wrap:eq(0)").next(".gs-tab-content"),a=$(this).index();$(this).addClass("current").siblings().removeClass("current"),t.find(".gs-tab-item:eq("+a+")").addClass("gs-tab-show").siblings().removeClass("gs-tab-show"),GESHOP_UTIL&&GESHOP_UTIL.goodsLazy(t.find(".gs-tab-item:eq("+a+") img.js-geshopImg-lazyload")),$("html,body").animate({scrollTop:$(this).closest(".geshop-component-box").offset().top-GESHOP_UTIL.getSiteFiedHeader()},500)}),a(),setInterval(function(){a()},1e3);var d=[];function e(e){$.each(d,function(t,a){if(1==a.tabWrap.data("tab-fix")){a.tabWrap.offset().top,$(a.tab).closest(".geshop-component-box").data("id");e>=a.tabWrap.offset().top&&a.tabWrap.offset().top+a.tabWrap.outerHeight(!0)>=a.tabHeight+e?(a.tab.css({position:"fixed",height:a.tabHeight,width:a.tabWrap.outerWidth(),left:a.tabWrap.offset().left,top:0,overflow:"hidden","z-index":9999}),a.tabWrap.parents('[data-key="U000041"]').addClass("js-geshop-nav-fixed"),$(".js-geshop-nav").length&&$(".js-geshop-nav").hide(),$('div[data-key="U000027"]').length&&$('div[data-key="U000027"]').find("ul").hide()):(a.tab.css({position:"static",top:0}),a.tabWrap.parents('[data-key="U000041"]').removeClass("js-geshop-nav-fixed"),$(".js-geshop-nav").length&&$(".js-geshop-nav").show(),$('div[data-key="U000027"]').length&&$('div[data-key="U000027"]').find("ul").show())}}),GEShopSiteCommon&&GEShopSiteCommon.jsNavFixed()}$(".gs_tab_wrap_fixed").each(function(t,a){var e=$(a);if(1!=e.data("isaddfixbox")){e.data("isaddfixbox",1);var s=e.find(".gs-tab-content"),i=e.find(".gs-tab-wrap").outerHeight(!0),n=e.find(".gs-tab-content").outerHeight(!0);e.find(".gs-tab-wrap").children().wrap('<div class="gs-tab-wrap-fixBox" style="height:'+i+'px"></div>');var o=e.find(".gs-tab-wrap-fixBox");d.push({tabWrap:e,tab:o,content:s,tabHeight:i,contentHeight:n})}}),$(window).scroll(function(){e($(this).scrollTop())}),$(window).resize(function(){e($(this).scrollTop())})});
