"use strict";var _createClass=function(){function n(i,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}return function(i,t,e){return t&&n(i.prototype,t),e&&n(i,e),i}}();function _classCallCheck(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}$(function(){var e=(_createClass(t,[{key:"init",value:function(){var i=this,t=GESHOP_STATIC;loadCss(t+"/resources/javascripts/library/swiper/swiper.min.css"),$LAB.script(t+"/resources/javascripts/library/swiper/swiper.3.4.spec.min.js").script(t+"/resources/javascripts/library/gs_laytpl.js?2018100601").wait(function(){gs_laytpl.config({open:"<%",close:"%>"}),i.initSwiper(),i.$box.hasClass("js_gs_tab_wrap_fixed")&&i.scrollCalBackFn()})}},{key:"initSwiper",value:function(){this.$box.find(".goods-nav-name > li").eq(0).addClass("current"),1064<=this.ulW?(this.$box.find(".icon-img-left").show(),this.$box.find(".icon-img-right").show()):(this.$box.find(".icon-img-left").hide(),this.$box.find(".icon-img-right").hide()),this.initSlideTab()}},{key:"initSlideTab",value:function(){var i=this;setTimeout(function(){new Swiper3(i.swiperTop.find(".swiper-container"),{slidesPerView:"auto",slideToClickedSlide:!0,nextButton:i.swiperTop.find(".next-btn"),prevButton:i.swiperTop.find(".pre-btn"),lazyLoading:!0})},100),this.handleSwiperClick(),this.getRankList()}},{key:"handleSwiperClick",value:function(){var t=this;this.swiperTop.on("click","li",function(){if($(this).addClass("current").siblings().removeClass("current"),t.cateid=$(this).attr("data-asyncdata-id")||-1,t.getRankList(),t.$box.hasClass(".gs-tab-wrap-fixbox")){var i=t.$box.find(".gs-tab-wrap-fixbox").offset().top;$("html,body").animate({scrollTop:i},500)}})}},{key:"getRankList",value:function(){var e=this,n=this.$box.find(".pc-leader-board-template").html(),a=this.$box.find(".leader-board-container"),i="undefined"!=typeof GESHOP_LANG?GESHOP_LANG:"en",t={type:2,cateid:this.cateid,lang:i,pageno:1,pagesize:this.pagesize,pipeline:"undefined"!=typeof GESHOP_PIPELINE?GESHOP_PIPELINE:""},s=GESHOP_INTERFACE.getrankdetail.url,o={content:JSON.stringify(t)};if(void 0===this.cateid||parseInt(this.cateid)<0)gs_laytpl(n).render({goodsInfo:[]},function(i){a.html(i)});else{var r=this.$box.attr("data-id");console.log(r),$.ajax({url:s,type:"get",dataType:"jsonp",data:o,cache:!0,jsonpCallback:"geshop_callback_"+r,success:function(i){var t=i.data;gs_laytpl(n).render(t,function(i){a.html(i),"undefined"!=typeof GS_GOODS_LAZY_FN?GS_GOODS_LAZY_FN(e.tabContent.find(".gs-tab-item img.js-geshopImg-lazyload")):e.tabContent.find(".gs-tab-item img.js-geshopImg-lazyload").each(function(i,t){$(t).attr("src",$(t).data("original"))}),"undefined"!=typeof GEShopSiteCommon&&GEShopSiteCommon.renderCurrency()})}})}"undefined"!=typeof GEShopSiteCommon&&GEShopSiteCommon.renderCurrency()}},{key:"scrollCalBackFn",value:function(){var a=this,s=this.$box.find(".gs-tab-wrap");s.wrap('<div class="gs-tab-wrap-fixbox"></div>'),$(window).on("scroll",function(){clearTimeout(a.timer);var n=$(this).scrollTop();a.timer=setTimeout(function(){var i=a.$box.find(".geshop-content").offset(),t=s.height(),e=s.find(".gs-tab-box");a.$box.data("id"),i.top<=n&&n<i.top+a.$box.find(".geshop-content").height()?(a.$box.find(".gs-tab-wrap-fixbox").height(t),e.css({position:"fixed",top:0,height:t,left:e.offset().left+"px","z-index":9999}),a.$box.addClass("js-geshop-nav-fixed"),$(".js-geshop-nav").length&&$(".js-geshop-nav").hide(),$('div[data-key="U000027"]').length&&$('div[data-key="U000027"]').find("ul").hide()):(e.css({position:"relative",top:"auto",left:"auto","z-index":100}),a.$box.removeClass("js-geshop-nav-fixed"),$(".js-geshop-nav").length&&$(".js-geshop-nav").show(),$('div[data-key="U000027"]').length&&$('div[data-key="U000027"]').find("ul").show(),GEShopSiteCommon&&GEShopSiteCommon.jsNavFixed())},2)})}}]),t);function t(i){_classCallCheck(this,t),this.$box=i,this.swiperTop=this.$box.find(".gs-tab-box"),this.tabContent=this.$box.find(".gs-tab-content"),this.ulW=this.$box.find(".goods-nav-name").outerWidth(),this.cateid=this.$box.find(".swiper-slide").eq(0).attr("data-asyncdata-id")||-1,this.pagesize=parseInt(this.$box.find(".pagesize").val()),this.timer=null,this.init()}$(".geshop-U000109-modal2").each(function(i,t){new e($(t))})});