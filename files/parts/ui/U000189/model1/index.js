"use strict";$(function(){var e=GESHOP_STATIC;loadCss(e+"/resources/javascripts/library/swiper/swiper.min.css"),$LAB.script(e+"/resources/javascripts/library/waterfull/masonry.pkgd.min.js").script(e+"/resources/javascripts/library/swiper/swiper.3.4.spec.min.js").wait(function(){function v(e,i){if(o)return!1;var a=e.find(".swiper-slide-active"),t=e.find(".swiper-container2").find(".swiper-slide-active"),s=t.attr("data-page"),n=t.attr("data-totalPage"),r=GESHOP_INTERFACE.community_post.url+"?cat_id="+i+"&country=&site=zafulcommunity&size=20&page="+s;if(!(1!=s&&n&&n-0<s-0)){var d=$('<div class="loadingGif" style="position: absolute;background:#fff;width: 100%; height: 50px;left: 0;bottom: 0;text-align: center;"><img src="https://geshopimg.logsss.com/uploads/K016no8NLPkfFRXZ5IEsv4OJrl7VD3Wm.gif" ></div>');t.css("paddingBottom",50).append(d);var o=!0;$.ajax({url:r,type:"get",data:{},success:function(e){o=!1,0==e.code&&(e.data.totalPage>=s&&0<e.data.totalPage?(function(e,i){for(var a=345*($("html").css("font-size").slice(0,-2)-0)/75,t=0,s=i.length;t<s;t++)if("undefined"!=typeof GS_GOODS_LAZY_FN){var n=$(' <a href="'+i[t].url+'" class="grid-item" style="height:'+a*i[t].big_pic_height/i[t].big_pic_width+'px"><img class="js-geshopImg-lazyload" src="" data-original="'+i[t].big_pic+'" alt="" height="'+a*i[t].big_pic_height/i[t].big_pic_width+'"></a>'),r=e.find(".grid").masonry({itemSelector:".grid-item"});r.append(n).masonry("appended",n).masonry(),GS_GOODS_LAZY_FN(n.find(".js-geshopImg-lazyload"))}else{n=$(' <a href="'+i[t].url+'" class="grid-item" style="height:'+a*i[t].big_pic_height/i[t].big_pic_width+'px"><img class="js-geshopImg-lazyload" src="'+i[t].big_pic+'" alt="" height="'+a*i[t].big_pic_height/i[t].big_pic_width+'"></a>');(r=e.find(".grid").masonry({itemSelector:".grid-item"})).append(n).masonry("appended",n).masonry()}}(a,e.data.lists),t.css("paddingBottom",0),d.remove(),++s,t.attr("data-page",s),t.attr("data-totalPage",e.data.totalPage)):GEShopSiteCommon.dialog.message("totalPage:"+e.data.totalPage))},error:function(e){GEShopSiteCommon.dialog.message(e.message)}})}}window.geshopIsLoading=!1,$(".geshop-u000189-model1").each(function(e,i){var f=$(i),a=[{id:1,cat_name:"nav1"},{id:1,cat_name:"nav2"},{id:1,cat_name:"nav3"}],t="",s="",n=f.find(".geshop-navswiper"),h=f.find(".swiper-container2"),r=n.find(".swiper-wrapper").data("cats"),d="",o=GESHOP_INTERFACE.community_category.url+"?cat_ids="+r+"&site=zafulcommunity";$.ajax({url:o,type:"get",timeout:2e3,success:function(e){0==e.code&&(0<e.data.length?((a=e.data).forEach(function(e,i){t+=0==i?"<div class='swiper-slide active'><span>"+e.cat_name+"</span></div>":"<div class='swiper-slide'><span>"+e.cat_name+"</span></div>",s+="<div class='swiper-slide' data-page=1><div class='grid'></div></div>"}),n.find(".swiper-wrapper").html(t),h.find(".swiper-wrapper").html(s),function(){var n=new Swiper3(f.find(".swiper-container2"),{paginationClickable:!0,uniqueNavElements:!1,speed:100,onSlideChangeStart:function(e){var i=f.find(".geshop-navswiper .swiper-slide");i.eq(e.activeIndex).addClass("active").siblings().removeClass("active");var a=p.slides[e.activeIndex],t=a.offsetLeft+a.clientWidth/2;if(p.setWrapperTransition(300),t<l/2)p.setWrapperTranslate(0);else if(g<t)p.setWrapperTranslate(c);else{var s=t-l/2;p.setWrapperTranslate(-s)}var n=$(window).scrollTop(),r=h.find(".swiper-slide").eq(e.previousIndex).find(".grid").height();i.eq(e.previousIndex).attr("data-scrolltop",n).attr("data-height",r),h.find(".swiper-slide .grid").css({position:"absolute",top:0,left:0,height:0,"z-index":"-1",overflow:"hidden"});var d=f.find(".geshop-navswiper .swiper-slide").eq(e.activeIndex).attr("data-scrolltop"),o=i.eq(e.activeIndex).attr("data-height")?i.eq(e.activeIndex).attr("data-height"):0;h.find(".swiper-slide").eq(e.activeIndex).find(".grid").css({position:"static",height:o,overflow:"visible"}),$("html,body").scrollTop(d||f.find(".geshop-navswiper").position().top)},onInit:function(){d=a[0].id,h.find(".swiper-slide-active").attr("data-load","load"),v(f,d)},onSlideChangeEnd:function(e){d=a[e.activeIndex].id,"load"!==h.find(".swiper-slide-active").attr("data-load")&&(v(f,d),h.find(".swiper-slide").eq(e.activeIndex).attr("data-load","load"))}}),i=f.find(".geshop-navswiper").offset().top;$(window).scroll(function(){var e=$(this).scrollTop();$(document).height()<=e+$(this).height()&&0!=e&&v(f,d),i<e?function(e){e.find(".geshop-navswiper").css({position:"fixed",top:0})}(f):(f.find(".geshop-navswiper").css("position","static"),f.find(".swiper-container2").css("paddingTop",20/75+"rem"))});var p=new Swiper3(".geshop-navswiper",{freeMode:!0,freeModeMomentumRatio:.5,slidesPerView:"auto"}),l=p.container[0].clientWidth,c=p.maxTranslate(),g=l/2-c;$(".swiper-container").on("touchstart",function(e){e.preventDefault()}),p.on("tap",function(e,i){n.slideTo(e.clickedIndex,300,!0);var a=e.slides[e.clickedIndex],t=a.offsetLeft+a.clientWidth/2;if(p.setWrapperTransition(300),t<l/2)p.setWrapperTranslate(0);else if(g<t)p.setWrapperTranslate(c);else{var s=t-l/2;p.setWrapperTranslate(-s)}$(".geshop-navswiper .swiper-slide").removeClass("active"),$(".geshop-navswiper .swiper-slide").eq(e.clickedIndex).addClass("active")})}()):GEShopSiteCommon.dialog.message("data-length:"+e.data.length))},error:function(e){GEShopSiteCommon.dialog.message(e.message)}})})})});