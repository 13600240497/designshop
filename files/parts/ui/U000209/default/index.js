"use strict";$(function(){$(".geshop-u000209-default").each(function(e,y){var s=GESHOP_STATIC;loadCss(s+"/resources/javascripts/library/swiper/swiper.min.css"),$LAB.script(s+"/resources/javascripts/library/swiper/swiper.3.4.spec.min.js").script(s+"/resources/javascripts/library/gs_laytpl.js").wait(function(){gs_laytpl.config({open:"<%",close:"%>"});var a,e,c=$(y),f=0,h=0,d=20,g=0,w=!1,n=c.find(".geshop-containr").data("fixed"),s=c.data("id"),o=window["navList_"+s],r=window["goodsSku_"+s];function i(o,d){if(u(),!(o.container.length<1)){var r=document.body.clientWidth,t=o.container[0].clientWidth,p=o.maxTranslate(),l=t/2-p;o.on("tap",function(e,s){var i=e.slides[e.clickedIndex];if(void 0!==i){w=!0,$(i).addClass("active").siblings().removeClass("active"),f=c.find(c.find(".geshop-navswiper").find(".swiper-wrapper").find(".swiper-slide.active")).index(),h=c.find(".geshop-secondswiper-"+f+" .swiper-slide.active").index(),g=c.find(".list-"+f+"-"+h).attr("data-curPage");var n=i.offsetLeft+i.clientWidth/2;if(o.setWrapperTransition(300),n<t/2)o.setWrapperTranslate(0);else if(l<n)o.setWrapperTranslate(p);else{var a=n-(t-r/375*20)/2;o.setWrapperTranslate(-a)}"function"==typeof d&&d(e.clickedIndex,c)}})}}function t(e){var s=new Swiper3(c.find(".geshop-secondswiper-"+e),{freeMode:!0,freeModeMomentumRatio:.5,slidesPerView:"auto"});s.setWrapperTranslate(0),i(s,p)}function p(e){if(null!=o&&void 0!==o&&0<o.length){var s=c.find(".list-"+f+"-"+h);c.find(".fbox").eq(f).addClass("on").siblings().removeClass("on"),c.find(".fbox.on .second-nav-list").removeClass("on").eq(h).addClass("on");var i=c.find(".secdBox").find(".geshop-secondswiper.on").hasClass("fixed"),n=s.attr("data-top");i&&(n<a?$("html,body").scrollTop(a):$("html,body").scrollTop(s.attr("data-top"))),void 0===s.attr("data-load")&&(l(f,h),s.attr("data-load","load"))}}function l(e,s){for(var i,n=0;n<r.length;n++)r[n].key==e+"-"+s&&2==r[n].skuFrom?i=r[n].ipsGoodsSKU:r[n].key==e+"-"+s&&1==r[n].skuFrom&&(i=r[n].inputSku);i=i.split(",");var a=Math.ceil(i.length/d),o=i.slice(g*d,(g+1)*d).join(",");g<a&&function(e){c.find(".giftImg").show();var s=GESHOP_INTERFACE.goods_async_detail.url,i=c.attr("data-id"),n={lang:GESHOP_LANG||"en",goodsSn:e,filterStock:1};window.GEShopCommonFn_Vue.$jsonp(s,n,{pid:i}).done(function(e){try{!function(e){var s=c.find(".cont-goodsList").html(),i=c.find(".list-"+f+"-"+h);gs_laytpl(s).render(e,function(e){var s=document.createElement("span");s.innerHTML=e,$(s).find(".js-geshopImg-lazyload").each(function(){$(this).attr("src",$(this).data("original"))}),i.append($(s)),c.find(".giftImg").hide(),w=!0,window.GLOBAL&&window.GLOBAL.currency&&window.GLOBAL.currency.change_html(),window.FUN&&window.FUN.currency&&window.FUN.currency.change_html()})}(e.data.goodsInfo)}catch(e){}})}(o)}void 0!==o&&(null==o||0==o.length||""==o?c.find(".js-geshopImg-lazyload").each(function(){$(this).attr("src",$(this).data("original"))}):(e=o,c.find(".geshop-ad-wrap").find("ul").html(""),c.find(".geshop-navswiper .swiper-wrapper").html(""),c.find(".secdBox").html(""),e.forEach(function(e,o){var s="",i="";0==o&&(s="on",i="active");var n="";n=e.banner?'<li class="'+s+'"><img src=" '+e.banner+' " alt="banner"></li>':'<li class="'+s+'"></li>',c.find(".geshop-ad-wrap").find("ul").append($(n));var a='<div class="swiper-slide '+i+'"><span>'+e.navName+"</span></div>";c.find(".geshop-navswiper").find(".swiper-wrapper").append($(a));var d='<div class="swiper-container geshop-secondswiper geshop-secondswiper-'+o+" "+s+'"><div class="swiper-wrapper"></div></div>';c.find(".secdBox").append($(d)),e.children.forEach(function(e,s){var i="",n="";e.sku_img?n='<img class="nav-img" src="'+e.sku_img+'"/>':e.secondTabImg&&(n='<img class="nav-img" src="'+e.secondTabImg+'"/>'),0==s&&(i="active");var a='<div class="swiper-slide '+i+'" style="background-color: '+e.tabBgcolor+'">'+n+"<span>"+e.navName+'</span><i class="btr" style="background-color: '+e.tabBgcolor+'"></i></div>';c.find(".geshop-secondswiper-"+o).find(".swiper-wrapper").append($(a))})}),u()));var v=c.find(".secdBox").height()+10*document.body.clientWidth/375;function u(){var e=c.find(".geshop-navswiper").find(".swiper-slide").last(),s=c.find(".geshop-secondswiper.on").find(".swiper-slide").last();e.position().left+e.width()<document.body.clientWidth?c.find(".geshop-navswiper .swiper-wrapper").addClass("wrap-center"):c.find(".geshop-navswiper .swiper-wrapper").removeClass("wrap-center"),s.position().left+s.width()<document.body.clientWidth?c.find(".geshop-secondswiper.on .swiper-wrapper").addClass("wrap-center"):c.find(".geshop-secondswiper.on .swiper-wrapper").removeClass("wrap-center")}var m=new Swiper3(c.find(".geshop-navswiper"),{freeMode:!0,freeModeMomentumRatio:.5,slidesPerView:"auto"});i(m,function(e){f=e,c.find(".geshop-ad-wrap ul li").eq(e).addClass("on").siblings().removeClass("on")}),p(),m.on("tap",function(e){w=!1;var s=e.clickedIndex;c.find(".geshop-secondswiper").eq(s).addClass("on").siblings().removeClass("on"),c.find(".geshop-secondswiper").eq(s).find(".swiper-slide").eq(0).addClass("active").siblings().removeClass("active"),void 0!==s&&(t(s),h=0,p())}),t(0),$(window).scroll(function(){a=Math.floor(c.find(".secdBox").offset().top);var e=c.height(),s=$(this).scrollTop(),i=$(this).height();1==n&&(a<=s&&s<a+e?(c.find(".secdBox").css({paddingBottom:v+"px"}),c.find(".geshop-secondswiper.on,.geshop-containr").addClass("fixed"),$(".js-geshop-nav").length&&$(".js-geshop-nav").hide(),c.addClass("js-geshop-nav-fixed"),$('div[data-key="U000030"]').length&&$('div[data-key="U000030"]').find("nav").hide()):(c.find(".geshop-secondswiper.on,.geshop-containr").removeClass("fixed"),c.find(".secdBox").css({paddingBottom:"0"}),c.removeClass("js-geshop-nav-fixed"),$(".js-geshop-nav").length&&$(".js-geshop-nav").show(),$('div[data-key="U000030"]').length&&$('div[data-key="U000030"]').find("nav").show(),GEShopSiteCommon&&GEShopSiteCommon.jsNavFixed())),c.find(".list-"+f+"-"+h).attr("data-top",s),e<=s+i&&0!=s&&w&&(w=!1,c.find(".list-"+f+"-"+h).attr("data-curPage",g),g++,l(f,h))})})})});